module.exports=[14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},46697,a=>{"use strict";a.s(["default",()=>j],46697);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(99996);a.i(69387);var f=a.i(60574);a.i(9912);var g=a.i(94318);let h=["ברקן","גרניום","דוריאן","הל"];var i=a.i(11769);function j(){let{id:a}=(0,d.useParams)(),j=(0,d.useRouter)(),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)({studentName:"",group:""}),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{l(!0);try{let b=(await (0,f.getDoc)((0,f.doc)(e.db,"forms",a))).data()||{};n(b),p(b.schema||[])}finally{l(!1)}})()},[a]);let y=(0,c.useMemo)(()=>o.find(a=>"phone"===a.type)?.id,[o]),z=(0,c.useMemo)(()=>o.find(a=>"email"===a.type)?.id,[o]);function A(a,b){t(c=>({...c,[a]:b}))}async function B(b){if(b.preventDefault(),r(""),!s.studentName?.trim())return r("נא למלא את שם החניכ.ה");if(!s.group)return r("נא לבחור קבוצה");if(z&&s[z]&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(s[z])))return r("כתובת אימייל לא תקינה");if(y&&s[y]&&!/^[0-9+\-\s()]{7,}$/.test(String(s[y])))return r("מספר טלפון לא תקין");if(o.filter(a=>a.required).some(a=>{let b=s[a.id];return"checkbox"===a.type?!Array.isArray(b)||0===b.length:"consent"===a.type?!0!==b:null==b||""===String(b).trim()}))return r("יש למלא את כל השדות המסומנים כחובה");try{x(!0);let b=(0,g.httpsCallable)(e.functions,"submitFormToDrive");await b({formId:a,answers:s,signatureDataUrl:u||null}),j.replace(`/f/${a}/thanks`)}catch(a){console.error(a),r(a?.message||a?.code||"אירעה שגיאה בשליחה")}finally{x(!1)}}return k?(0,b.jsx)("main",{dir:"rtl",className:"p-6 max-w-3xl mx-auto",children:"טוען…"}):m?(0,b.jsxs)("main",{dir:"rtl",className:"p-6 max-w-3xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold mb-2",children:m.title||"טופס"}),m.descriptionHtml&&(0,b.jsx)("div",{className:"prose prose-sm max-w-none mb-6",dangerouslySetInnerHTML:{__html:m.descriptionHtml}}),(0,b.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"border rounded p-3 bg-white",children:[(0,b.jsxs)("div",{className:"text-sm mb-1",children:["שם החניכ.ה ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)("input",{className:"border p-2 w-full rounded",value:s.studentName||"",onChange:a=>A("studentName",a.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"border rounded p-3 bg-white",children:[(0,b.jsxs)("div",{className:"text-sm mb-1",children:["קבוצה בחממה ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsxs)("select",{className:"border p-2 w-full rounded",value:s.group||"",onChange:a=>A("group",a.target.value),required:!0,children:[(0,b.jsx)("option",{value:"",children:"בחר/י קבוצה…"}),h.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),o.map(a=>(0,b.jsxs)("div",{className:"border rounded p-3 bg-white",children:[(0,b.jsxs)("div",{className:"text-sm mb-1",children:[a.label," ",a.required&&(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),"text"===a.type&&(0,b.jsx)("input",{className:"border p-2 w-full rounded",value:s[a.id]||"",onChange:b=>A(a.id,b.target.value),required:a.required}),"textarea"===a.type&&(0,b.jsx)("textarea",{className:"border p-2 w-full rounded",value:s[a.id]||"",onChange:b=>A(a.id,b.target.value),required:a.required,rows:4}),"parentName"===a.type&&(0,b.jsx)("input",{className:"border p-2 w-full rounded",value:s[a.id]||"",onChange:b=>A(a.id,b.target.value),placeholder:"שם ההורה",required:a.required}),"number"===a.type&&(0,b.jsx)("input",{type:"number",className:"border p-2 w-full rounded",value:s[a.id]??"",onChange:b=>A(a.id,b.target.value),required:a.required}),"phone"===a.type&&(0,b.jsx)("input",{type:"tel",inputMode:"tel",className:"border p-2 w-full rounded",value:s[a.id]||"",onChange:b=>A(a.id,b.target.value),placeholder:"למשל: 050-1234567",required:a.required}),"email"===a.type&&(0,b.jsx)("input",{type:"email",className:"border p-2 w-full rounded",value:s[a.id]||"",onChange:b=>A(a.id,b.target.value),placeholder:"name@example.com",required:a.required}),"consent"===a.type&&(0,b.jsxs)("label",{className:"flex items-start gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!s[a.id],onChange:b=>A(a.id,b.target.checked),required:a.required}),(0,b.jsx)("span",{className:"text-sm leading-6",children:a.description||"אני מאשר/ת..."})]}),"select"===a.type&&(0,b.jsxs)("select",{className:"border p-2 w-full rounded",value:s[a.id]||"",onChange:b=>A(a.id,b.target.value),required:a.required,children:[(0,b.jsx)("option",{value:"",children:"בחר/י…"}),(a.options||[]).map((a,c)=>(0,b.jsx)("option",{value:a,children:a},c))]}),"radio"===a.type&&(0,b.jsx)("div",{className:"flex flex-col gap-1",children:(a.options||[]).map((c,d)=>(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:a.id,checked:s[a.id]===c,onChange:()=>A(a.id,c),required:a.required&&0===d&&!s[a.id]}),(0,b.jsx)("span",{children:c})]},d))}),"checkbox"===a.type&&(0,b.jsx)("div",{className:"flex flex-col gap-1",children:(a.options||[]).map((c,d)=>{let e=Array.isArray(s[a.id])&&s[a.id].includes(c);return(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:e,onChange:b=>{var d,e;return d=a.id,e=b.target.checked,void t(a=>{let b=Array.isArray(a[d])?a[d]:[],f=e?Array.from(new Set([...b,c])):b.filter(a=>a!==c);return{...a,[d]:f}})}}),(0,b.jsx)("span",{children:c})]},d)})}),"signature"===a.type&&(0,b.jsx)(i.default,{onSave:a=>v(a)})]},a.id)),q&&(0,b.jsx)("div",{className:"text-red-600",children:q}),(0,b.jsx)("button",{type:"submit",className:"border p-2 rounded",disabled:w,children:w?"שולח…":"שלח"})]})]}):(0,b.jsx)("main",{dir:"rtl",className:"p-6 max-w-3xl mx-auto",children:"הטופס לא נמצא."})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__37298883._.js.map