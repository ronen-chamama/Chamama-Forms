{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/chamama-forms/lib/firebaseClient.ts"],"sourcesContent":["// lib/firebaseClient.ts\r\nimport { initializeApp, getApps, type FirebaseApp } from \"firebase/app\";\r\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\r\nimport { getFirestore, connectFirestoreEmulator } from \"firebase/firestore\";\r\nimport { getStorage, connectStorageEmulator } from \"firebase/storage\";\r\nimport { getFunctions, connectFunctionsEmulator } from \"firebase/functions\";\r\n\r\n// --- אבחון: ודא שמשתני הסביבה קיימים (גם בשרת של Next וגם בדפדפן) ---\r\nconst cfg = {\r\n  apiKey: process.env.NEXT_PUBLIC_FB_API_KEY,\r\n  authDomain: process.env.NEXT_PUBLIC_FB_AUTH_DOMAIN,\r\n  projectId: process.env.NEXT_PUBLIC_FB_PROJECT_ID,\r\n  storageBucket: process.env.NEXT_PUBLIC_FB_STORAGE_BUCKET,\r\n  appId: process.env.NEXT_PUBLIC_FB_APP_ID,\r\n};\r\n\r\n// נבדוק את כל המפתחות החיוניים ונזרוק שגיאה ברורה אם חסר משהו:\r\nconst missing = Object.entries(cfg).filter(([_, v]) => !v).map(([k]) => k);\r\nif (missing.length) {\r\n  // חשוב: ההודעה תופיע במסוף וגם תעצור את הייבוא בצורה ברורה\r\n  throw new Error(\r\n    \"Firebase env missing: \" + missing.join(\", \") +\r\n    \". ודא שיש קובץ .env.local בשורש הפרויקט עם NEXT_PUBLIC_FB_* אמיתיים, ואתחל מחדש את dev.\"\r\n  );\r\n}\r\n\r\nconst firebaseConfig = cfg as {\r\n  apiKey: string; authDomain: string; projectId: string; storageBucket: string; appId: string;\r\n};\r\n\r\nlet app: FirebaseApp;\r\ntry {\r\n  app = getApps().length ? getApps()[0] : initializeApp(firebaseConfig);\r\n} catch (e) {\r\n  // לוג מועיל לאבחון\r\n  // eslint-disable-next-line no-console\r\n  console.error(\"Firebase initializeApp failed. projectId:\", firebaseConfig.projectId, e);\r\n  throw e;\r\n}\r\n\r\nexport { app };\r\nexport const auth = getAuth(app);\r\nexport const db = getFirestore(app);\r\nexport const storage = getStorage(app);\r\nexport const functions = getFunctions(app);\r\n\r\n\r\n// חיבור לאמולטורים בלוקאל\r\nif (typeof window !== \"undefined\" && location.hostname === \"localhost\") {\r\n  try { connectAuthEmulator(auth, \"http://localhost:9099\"); } catch {}\r\n  try { connectFirestoreEmulator(db, \"localhost\", 8080); } catch {}\r\n  try { connectStorageEmulator(storage, \"localhost\", 9199); } catch {}\r\n  try { connectFunctionsEmulator(functions, \"localhost\", 5001); } catch {}\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;;;;;;;;AACxB;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAEA,uEAAuE;AACvE,MAAM,MAAM;IACV,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,KAAK;AACP;AAEA,+DAA+D;AAC/D,MAAM,UAAU,OAAO,OAAO,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,GAAK,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,GAAK;AACxE,IAAI,QAAQ,MAAM,EAAE;IAClB,2DAA2D;IAC3D,MAAM,IAAI,MACR,2BAA2B,QAAQ,IAAI,CAAC,QACxC;AAEJ;AAEA,MAAM,iBAAiB;AAIvB,IAAI;AACJ,IAAI;IACF,MAAM,IAAA,2KAAO,IAAG,MAAM,GAAG,IAAA,2KAAO,GAAE,CAAC,EAAE,GAAG,IAAA,iLAAa,EAAC;AACxD,EAAE,OAAO,GAAG;IACV,mBAAmB;IACnB,sCAAsC;IACtC,QAAQ,KAAK,CAAC,6CAA6C,eAAe,SAAS,EAAE;IACrF,MAAM;AACR;;AAGO,MAAM,OAAO,IAAA,6KAAO,EAAC;AACrB,MAAM,KAAK,IAAA,iLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,kMAAU,EAAC;AAC3B,MAAM,YAAY,IAAA,sLAAY,EAAC;AAGtC,0BAA0B;AAC1B","debugId":null}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///C:/chamama-forms/app/login/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { auth } from \"@/lib/firebaseClient\";\r\nimport { signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged } from \"firebase/auth\";\r\nimport { useSearchParams, useRouter } from \"next/navigation\";\r\n\r\nexport default function LoginPage() {\r\n  const [email,setEmail]=useState(\"\");\r\n  const [password,setPassword]=useState(\"\");\r\n  const [msg,setMsg]=useState(\"\");\r\n  const searchParams = useSearchParams();\r\n  const router = useRouter();\r\n\r\n  // אם כבר מחוברים — ננווט מיד\r\n  useEffect(() => {\r\n    const unsub = onAuthStateChanged(auth, (u) => {\r\n      if (u) {\r\n        const next = searchParams.get(\"next\") || \"/app\"; // ברירת מחדל\r\n        router.replace(next);\r\n      }\r\n    });\r\n    return () => unsub();\r\n  }, [router, searchParams]);\r\n\r\n  async function onLogin(e:any){\r\n    e.preventDefault();\r\n    setMsg(\"\");\r\n    try{\r\n      await signInWithEmailAndPassword(auth,email,password);\r\n      const next = searchParams.get(\"next\") || \"/app\"; // אם מגיעים עם next=?ננווט אליו\r\n      router.replace(next);\r\n    }catch(err:any){\r\n      setMsg(err.message);\r\n    }\r\n  }\r\n\r\n  async function onReset(){\r\n    if(!email){ setMsg(\"נא להקליד אימייל\"); return; }\r\n    try{ await sendPasswordResetEmail(auth,email); setMsg(\"נשלח מייל איפוס סיסמה\"); }\r\n    catch(err:any){ setMsg(err.message); }\r\n  }\r\n\r\n  return (\r\n    <main dir=\"rtl\" className=\"p-6 max-w-md mx-auto\">\r\n      <h1 className=\"text-2xl mb-4\">התחברות</h1>\r\n      <form onSubmit={onLogin} className=\"flex flex-col gap-3\">\r\n        <input placeholder=\"אימייל\" value={email} onChange={e=>setEmail(e.target.value)} className=\"border p-2\" />\r\n        <input placeholder=\"סיסמה\" type=\"password\" value={password} onChange={e=>setPassword(e.target.value)} className=\"border p-2\" />\r\n        <button className=\"border p-2\">כניסה</button>\r\n      </form>\r\n      <button onClick={onReset} className=\"underline mt-3\">שכחתי סיסמה</button>\r\n      {msg && <p className=\"mt-3 text-sm text-red-600\">{msg}</p>}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;AACA;AAJA;;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,OAAM,SAAS,GAAC,IAAA,iNAAQ,EAAC;IAChC,MAAM,CAAC,UAAS,YAAY,GAAC,IAAA,iNAAQ,EAAC;IACtC,MAAM,CAAC,KAAI,OAAO,GAAC,IAAA,iNAAQ,EAAC;IAC5B,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,SAAS,IAAA,+IAAS;IAExB,6BAA6B;IAC7B,IAAA,kNAAS,EAAC;QACR,MAAM,QAAQ,IAAA,wLAAkB,EAAC,6HAAI,EAAE,CAAC;YACtC,IAAI,GAAG;gBACL,MAAM,OAAO,aAAa,GAAG,CAAC,WAAW,QAAQ,aAAa;gBAC9D,OAAO,OAAO,CAAC;YACjB;QACF;QACA,OAAO,IAAM;IACf,GAAG;QAAC;QAAQ;KAAa;IAEzB,eAAe,QAAQ,CAAK;QAC1B,EAAE,cAAc;QAChB,OAAO;QACP,IAAG;YACD,MAAM,IAAA,gMAA0B,EAAC,6HAAI,EAAC,OAAM;YAC5C,MAAM,OAAO,aAAa,GAAG,CAAC,WAAW,QAAQ,gCAAgC;YACjF,OAAO,OAAO,CAAC;QACjB,EAAC,OAAM,KAAQ;YACb,OAAO,IAAI,OAAO;QACpB;IACF;IAEA,eAAe;QACb,IAAG,CAAC,OAAM;YAAE,OAAO;YAAqB;QAAQ;QAChD,IAAG;YAAE,MAAM,IAAA,4LAAsB,EAAC,6HAAI,EAAC;YAAQ,OAAO;QAA0B,EAChF,OAAM,KAAQ;YAAE,OAAO,IAAI,OAAO;QAAG;IACvC;IAEA,qBACE,8OAAC;QAAK,KAAI;QAAM,WAAU;;0BACxB,8OAAC;gBAAG,WAAU;0BAAgB;;;;;;0BAC9B,8OAAC;gBAAK,UAAU;gBAAS,WAAU;;kCACjC,8OAAC;wBAAM,aAAY;wBAAS,OAAO;wBAAO,UAAU,CAAA,IAAG,SAAS,EAAE,MAAM,CAAC,KAAK;wBAAG,WAAU;;;;;;kCAC3F,8OAAC;wBAAM,aAAY;wBAAQ,MAAK;wBAAW,OAAO;wBAAU,UAAU,CAAA,IAAG,YAAY,EAAE,MAAM,CAAC,KAAK;wBAAG,WAAU;;;;;;kCAChH,8OAAC;wBAAO,WAAU;kCAAa;;;;;;;;;;;;0BAEjC,8OAAC;gBAAO,SAAS;gBAAS,WAAU;0BAAiB;;;;;;YACpD,qBAAO,8OAAC;gBAAE,WAAU;0BAA6B;;;;;;;;;;;;AAGxD","debugId":null}}]
}