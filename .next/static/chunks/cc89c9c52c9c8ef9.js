(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,n)=>{t.exports=e.r(76562)},11663,52831,61978,e=>{"use strict";e.s(["auth",()=>S,"db",()=>D,"functions",()=>P,"storage",()=>O],11663),e.i(47167),e.i(14539);var t=e.i(76510);e.i(51718);var n=e.i(18357);e.i(36180);var r=e.i(98925);e.i(61086);var a=e.i(27215);e.s([],61978),e.s(["connectFunctionsEmulator",()=>A,"getFunctions",()=>T,"httpsCallable",()=>E],52831);var i=e.i(92953),s=e.i(97427),o=e.i(8070);function l(e,t){let n={};for(let r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function c(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>c(e));if("function"==typeof e||"object"==typeof e)return l(e,e=>c(e));throw Error("Data cannot be encoded in JSON: "+e)}function u(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{let t=Number(e.value);if(isNaN(t))throw Error("Data cannot be decoded from JSON: "+e);return t}default:throw Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>u(e)):"function"==typeof e||"object"==typeof e?l(e,e=>u(e)):e}let d="functions",p={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class h extends s.FirebaseError{constructor(e,t,n){super("".concat(d,"/").concat(e),t||""),this.details=n,Object.setPrototypeOf(this,h.prototype)}}function m(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),a=r;try{let e=t&&t.error;if(e){let t=e.status;if("string"==typeof t){if(!p[t])return new h("internal","internal");r=p[t],a=t}let i=e.message;"string"==typeof i&&(a=i),n=e.details,void 0!==n&&(n=u(n))}}catch(e){}return"ok"===r?null:new h(r,a,n)}class g{async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){let t=await this.getAuthToken();return{authToken:t,messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}constructor(e,t,n,r){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,i._isFirebaseServerApp)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(e=>this.auth=e,()=>{}),this.messaging||n.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null==r||r.get().then(e=>this.appCheck=e,()=>{})}}let f="us-central1",b=/^data: (.*?)(?:\n|$)/;class x{_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;if(null!==this.emulatorOrigin){let n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}constructor(e,t,n,r,a=f,i=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return fetch(...t)}){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new g(e,t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{let e=new URL(a);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=f}catch(e){this.customDomain=null,this.region=a}}}function k(e){return e.emulatorOrigin&&(0,s.isCloudWorkstation)(e.emulatorOrigin)?"include":void 0}async function v(e,t,n,r,a){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n,credentials:k(a)})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}async function y(e,t){let n={},r=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),null!==r.appCheckToken&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}async function N(e,t,n,r){var a;let i,s={data:n=c(n)},o=await y(e,r),l=(a=r.timeout||7e4,i=null,{promise:new Promise((e,t)=>{i=setTimeout(()=>{t(new h("deadline-exceeded","deadline-exceeded"))},a)}),cancel:()=>{i&&clearTimeout(i)}}),d=await Promise.race([v(t,s,o,e.fetchImpl,e),l.promise,e.cancelAllRequests]);if(l.cancel(),!d)throw new h("cancelled","Firebase Functions instance was deleted.");let p=m(d.status,d.json);if(p)throw p;if(!d.json)throw new h("internal","Response is not valid JSON object.");let g=d.json.data;if(void 0===g&&(g=d.json.result),void 0===g)throw new h("internal","Response is missing data field.");return{data:u(g)}}async function w(e,t,n,r){var a;let i,s,o,l={data:n=c(n)},d=await y(e,r);d["Content-Type"]="application/json",d.Accept="text/event-stream";try{i=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(l),headers:d,signal:null==r?void 0:r.signal,credentials:k(e)})}catch(t){if(t instanceof Error&&"AbortError"===t.name){let e=new h("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let e=m(0,null);return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let p=new Promise((e,t)=>{s=e,o=t});null==r||null==(a=r.signal)||a.addEventListener("abort",()=>{let e=new h("cancelled","Request was cancelled.");o(e)});let g=function(e,t,n,r){let a=(e,r)=>{let a=e.match(b);if(!a)return;let i=a[1];try{let e=JSON.parse(i);if("result"in e)return void t(u(e.result));if("message"in e)return void r.enqueue(u(e.message));if("error"in e){let t=m(0,e);r.error(t),n(t);return}}catch(e){if(e instanceof h){r.error(e),n(e);return}}},i=new TextDecoder;return new ReadableStream({start(t){let s="";return o();async function o(){if(null==r?void 0:r.aborted){let e=new h("cancelled","Request was cancelled");return t.error(e),n(e),Promise.resolve()}try{let{value:l,done:c}=await e.read();if(c){s.trim()&&a(s.trim(),t),t.close();return}if(null==r?void 0:r.aborted){let r=new h("cancelled","Request was cancelled");t.error(r),n(r),await e.cancel();return}let u=(s+=i.decode(l,{stream:!0})).split("\n");for(let e of(s=u.pop()||"",u))e.trim()&&a(e.trim(),t);return o()}catch(r){let e=r instanceof h?r:m(0,null);t.error(e),n(e)}}},cancel:()=>e.cancel()})}(i.body.getReader(),s,o,null==r?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){let e=g.getReader();return{async next(){let{value:t,done:n}=await e.read();return{value:t,done:n}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:p}}let j="@firebase/functions",C="0.13.1";function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.getApp)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,n=(0,i._getProvider)((0,s.getModularInstance)(e),d).getImmediate({identifier:t}),r=(0,s.getDefaultEmulatorHostnameAndPort)("functions");return r&&A(n,...r),n}function A(e,t,n){var r=(0,s.getModularInstance)(e);let a=(0,s.isCloudWorkstation)(t);r.emulatorOrigin="http".concat(a?"s":"","://").concat(t,":").concat(n),a&&((0,s.pingServer)(r.emulatorOrigin+"/backends"),(0,s.updateEmulatorBanner)("Functions",!0))}function E(e,t,n){var r=(0,s.getModularInstance)(e);let a=e=>(function(e,t,n,r){let a=e._url(t);return N(e,a,n,r)})(r,t,e,n||{});return a.stream=(e,n)=>(function(e,t,n,r){let a=e._url(t);return w(e,a,n,r||{})})(r,t,e,n),a}(0,i._registerComponent)(new o.Component(d,(e,t)=>{let{instanceIdentifier:n}=t,r=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal");return new x(r,a,e.getProvider("messaging-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),(0,i.registerVersion)(j,C,void 0),(0,i.registerVersion)(j,C,"esm2020");let I=(0,t.getApps)().length?(0,t.getApp)():(0,t.initializeApp)({apiKey:"AIzaSyDYQfltkDCGJvCgtgCNzVfyA5nUJy5KNNc",authDomain:"chamama-addfd.firebaseapp.com",projectId:"chamama-addfd",storageBucket:"chamama-addfd.firebasestorage.app",appId:"1:542858138442:web:abe34a5d9cccf70af5e7b3"}),S=(0,n.getAuth)(I),D=(0,r.getFirestore)(I),O=(0,a.getStorage)(I),P=T(I,"us-central1");"localhost"===location.hostname&&((0,n.connectAuthEmulator)(S,"http://127.0.0.1:9099"),(0,r.connectFirestoreEmulator)(D,"127.0.0.1",8080),(0,a.connectStorageEmulator)(O,"127.0.0.1",9199),A(P,"127.0.0.1",5001))},93400,e=>{"use strict";e.s(["default",()=>c],93400);var t=e.i(43476),n=e.i(71645),r=e.i(18566);e.i(51718);var a=e.i(18357),i=e.i(11663);e.i(36180);var s=e.i(98925);function o(r){let{value:a,onChange:i,placeholder:s="תיאור הטופס…"}=r,o=(0,n.useRef)(null),l=(0,n.useRef)(null),c=(0,n.useRef)(!1),u=(0,n.useRef)("");return(0,n.useEffect)(()=>{let t=!1;return(async()=>{if(c.current||!o.current)return;c.current=!0;let n=(await e.A(95727)).default;o.current.innerHTML="";let r=document.createElement("div");o.current.appendChild(r);let d=new n(r,{theme:"snow",modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]},{direction:"rtl"}],["link","clean"]],clipboard:{matchVisual:!0}},formats:["header","bold","italic","underline","strike","list","bullet","align","direction","link"],placeholder:s});l.current=d,d.root.setAttribute("dir","rtl"),a&&(d.clipboard.dangerouslyPasteHTML(a),u.current=d.root.innerHTML),d.on("text-change",()=>{if(t)return;let e=d.root.innerHTML;e!==u.current&&(u.current=e,i(e))})})(),()=>{t=!0}},[]),(0,n.useEffect)(()=>{let e=l.current;e&&a&&a!==u.current&&(e.setContents([]),e.clipboard.dangerouslyPasteHTML(a),u.current=e.root.innerHTML)},[a]),(0,t.jsx)("div",{ref:o,className:"bg-white rounded"})}function l(e){let{value:r,onChange:a,title:i="אפשרויות"}=e,s=(0,n.useRef)(null);function o(){a([...r||[],""]),setTimeout(()=>{var e;return null==(e=s.current)?void 0:e.focus()},0)}return(0,n.useEffect)(()=>{let e=r.length>1&&""===r[r.length-1]?r.slice(0,-1):r;e!==r&&a(e)},[]),(0,t.jsxs)("div",{dir:"rtl",className:"space-y-2",children:[(0,t.jsx)("div",{className:"font-medium",children:i}),(0,t.jsx)("div",{className:"space-y-2",children:(r||[]).map((e,n)=>{let i=n===r.length-1;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{ref:i?s:void 0,className:"border rounded p-2 flex-1",placeholder:"אפשרות #".concat(n+1),value:e,onChange:e=>(function(e,t){let n=[...r];n[e]=t,a(n)})(n,e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),r[n].trim()&&o())}}),(0,t.jsx)("button",{type:"button",className:"border rounded px-2 py-1",onClick:()=>{a(r.filter((e,t)=>t!==n))},"aria-label":"מחק",title:"מחק אפשרות",children:"✕"})]},n)})}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("button",{type:"button",className:"border rounded px-3 py-2",onClick:o,children:"+"})})]})}function c(){let{id:e}=(0,r.useParams)();(0,r.useRouter)();let[c,u]=(0,n.useState)(""),[d,p]=(0,n.useState)(""),[h,m]=(0,n.useState)([]),[g,f]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!0);function k(e){let t={id:"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"id-"+Math.random().toString(36).slice(2)+Date.now().toString(36),type:e,label:"",required:!1};switch(e){case"text":t.label="שדה טקסט";break;case"textarea":t.label="איזור טקסט";break;case"parentName":t.label="שם ההורה";break;case"number":t.label="מספר";break;case"phone":t.label="טלפון";break;case"email":t.label='דוא"ל';break;case"consent":t.label="הסכמה",t.description="אני מאשר/ת ...";break;case"select":t.label="בחירה מרשימה",t.options=[];break;case"radio":t.label="בחירה",t.options=[];break;case"checkbox":t.label="בחירה מרובה",t.options=[];break;case"signature":t.label="חתימה"}m(e=>[...e,t])}function v(e,t){m(n=>n.map((n,r)=>r===e?{...n,...t}:n))}async function y(){try{f(!0),await (0,s.updateDoc)((0,s.doc)(i.db,"forms",e),{title:c,descriptionHtml:d,schema:h,updatedAt:(0,s.serverTimestamp)()})}finally{f(!1)}}return(0,n.useEffect)(()=>{let e=(0,a.onAuthStateChanged)(i.auth,e=>{e||(location.href="/login")});return()=>e()},[]),(0,n.useEffect)(()=>{let t=!1;return(async()=>{x(!0);try{let n=(await (0,s.getDoc)((0,s.doc)(i.db,"forms",e))).data();t||(u((null==n?void 0:n.title)||""),p((null==n?void 0:n.descriptionHtml)||""),m((null==n?void 0:n.schema)||[]))}finally{t||x(!1)}})(),()=>{t=!0}},[e]),b?(0,t.jsx)("main",{dir:"rtl",className:"p-6 max-w-6xl mx-auto",children:"טוען…"}):(0,t.jsxs)("main",{dir:"rtl",className:"p-6 max-w-6xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[(0,t.jsx)("input",{className:"border p-2 rounded flex-1 text-xl",placeholder:"כותרת הטופס (נשמר גם כשם הטופס)",value:c,onChange:e=>u(e.target.value)}),(0,t.jsx)("button",{onClick:y,className:"border p-2 rounded",disabled:g,children:g?"שומר…":"שמור"}),(0,t.jsx)("button",{onClick:function(){window.open("/f/".concat(e),"_blank","noopener,noreferrer")},className:"border p-2 rounded",children:"תצוגה להורה"})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(o,{value:d,onChange:p})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsx)("section",{className:"lg:col-span-2 lg:order-1 space-y-3",children:(0,t.jsxs)("ul",{className:"space-y-3",children:[0===h.length&&(0,t.jsx)("li",{className:"text-gray-500",children:"טרם הוספת שדות. הוסף רכיבים מהצד הימני."}),h.map((e,n)=>{var r;return(0,t.jsxs)("li",{className:"border rounded p-3 bg-white",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs border px-2 py-1 rounded",children:e.type}),(0,t.jsx)("input",{className:"border p-1 flex-1 min-w-[200px]",value:e.label,onChange:e=>v(n,{label:e.target.value}),placeholder:"כותרת שדה"}),(0,t.jsxs)("label",{className:"flex items-center gap-1 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:!!e.required,onChange:e=>v(n,{required:e.target.checked})}),"נדרש"]}),(0,t.jsx)("button",{type:"button",className:"text-red-600",onClick:()=>{m(e=>e.filter((e,t)=>t!==n))},children:"מחק"})]}),["select","radio","checkbox"].includes(e.type)&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(l,{title:"אפשרויות לבחירה",value:null!=(r=e.options)?r:[],onChange:e=>v(n,{options:e})})}),"consent"===e.type&&(0,t.jsx)("textarea",{className:"border p-2 w-full mt-2 rounded",placeholder:"תוכן ההסכמה שיוצג ליד הצ'קבוקס",value:e.description||"",onChange:e=>v(n,{description:e.target.value})})]},e.id)})]})}),(0,t.jsx)("aside",{className:"lg:col-span-1 lg:order-2 space-y-2",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("text"),children:"שדה טקסט"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("textarea"),children:"איזור טקסט"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("parentName"),children:"שם ההורה"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("number"),children:"שדה מספר"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("phone"),children:"טלפון"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("email"),children:'דוא"ל'}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("consent"),children:"הסכמה"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("select"),children:"בחירה מרשימה"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("radio"),children:"בחירה (radio)"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("checkbox"),children:"בחירה מרובה"}),(0,t.jsx)("button",{className:"border p-2 rounded",onClick:()=>k("signature"),children:"חתימה"})]})})]})]})}},95727,e=>{e.v(t=>Promise.all(["static/chunks/8bd2d9bd55c582cf.js"].map(t=>e.l(t))).then(()=>t(86373)))}]);