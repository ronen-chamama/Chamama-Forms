(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11663,52831,61978,e=>{"use strict";let t;e.s(["auth",()=>D,"db",()=>P,"functions",()=>U,"storage",()=>R],11663),e.i(47167),e.i(14539);var n=e.i(76510);e.i(51718);var a=e.i(18357);e.i(36180);var r=e.i(98925);e.i(61086);var i=e.i(27215);e.s([],61978),e.s(["connectFunctionsEmulator",()=>E,"getFunctions",()=>T,"httpsCallable",()=>I],52831);var o=e.i(92953),s=e.i(97427),l=e.i(8070);function c(e,t){let n={};for(let a in e)e.hasOwnProperty(a)&&(n[a]=t(e[a]));return n}function u(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>u(e));if("function"==typeof e||"object"==typeof e)return c(e,e=>u(e));throw Error("Data cannot be encoded in JSON: "+e)}function d(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{let t=Number(e.value);if(isNaN(t))throw Error("Data cannot be decoded from JSON: "+e);return t}default:throw Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>d(e)):"function"==typeof e||"object"==typeof e?c(e,e=>d(e)):e}let p="functions",h={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class m extends s.FirebaseError{constructor(e,t,n){super("".concat(p,"/").concat(e),t||""),this.details=n,Object.setPrototypeOf(this,m.prototype)}}function g(e,t){let n,a=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=a;try{let e=t&&t.error;if(e){let t=e.status;if("string"==typeof t){if(!h[t])return new m("internal","internal");a=h[t],r=t}let i=e.message;"string"==typeof i&&(r=i),n=e.details,void 0!==n&&(n=d(n))}}catch(e){}return"ok"===a?null:new m(a,r,n)}class f{async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){let t=await this.getAuthToken();return{authToken:t,messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}constructor(e,t,n,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,o._isFirebaseServerApp)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(e=>this.auth=e,()=>{}),this.messaging||n.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null==a||a.get().then(e=>this.appCheck=e,()=>{})}}let b="us-central1",v=/^data: (.*?)(?:\n|$)/;class y{_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;if(null!==this.emulatorOrigin){let n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}constructor(e,t,n,a,r=b,i=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return fetch(...t)}){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new f(e,t,n,a),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{let e=new URL(r);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=b}catch(e){this.customDomain=null,this.region=r}}}function k(e){return e.emulatorOrigin&&(0,s.isCloudWorkstation)(e.emulatorOrigin)?"include":void 0}async function x(e,t,n,a,r){let i;n["Content-Type"]="application/json";try{i=await a(e,{method:"POST",body:JSON.stringify(t),headers:n,credentials:k(r)})}catch(e){return{status:0,json:null}}let o=null;try{o=await i.json()}catch(e){}return{status:i.status,json:o}}async function N(e,t){let n={},a=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return a.authToken&&(n.Authorization="Bearer "+a.authToken),a.messagingToken&&(n["Firebase-Instance-ID-Token"]=a.messagingToken),null!==a.appCheckToken&&(n["X-Firebase-AppCheck"]=a.appCheckToken),n}async function w(e,t,n,a){var r;let i,o={data:n=u(n)},s=await N(e,a),l=(r=a.timeout||7e4,i=null,{promise:new Promise((e,t)=>{i=setTimeout(()=>{t(new m("deadline-exceeded","deadline-exceeded"))},r)}),cancel:()=>{i&&clearTimeout(i)}}),c=await Promise.race([x(t,o,s,e.fetchImpl,e),l.promise,e.cancelAllRequests]);if(l.cancel(),!c)throw new m("cancelled","Firebase Functions instance was deleted.");let p=g(c.status,c.json);if(p)throw p;if(!c.json)throw new m("internal","Response is not valid JSON object.");let h=c.json.data;if(void 0===h&&(h=c.json.result),void 0===h)throw new m("internal","Response is missing data field.");return{data:d(h)}}async function C(e,t,n,a){var r;let i,o,s,l={data:n=u(n)},c=await N(e,a);c["Content-Type"]="application/json",c.Accept="text/event-stream";try{i=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(l),headers:c,signal:null==a?void 0:a.signal,credentials:k(e)})}catch(t){if(t instanceof Error&&"AbortError"===t.name){let e=new m("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let e=g(0,null);return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let p=new Promise((e,t)=>{o=e,s=t});null==a||null==(r=a.signal)||r.addEventListener("abort",()=>{let e=new m("cancelled","Request was cancelled.");s(e)});let h=function(e,t,n,a){let r=(e,a)=>{let r=e.match(v);if(!r)return;let i=r[1];try{let e=JSON.parse(i);if("result"in e)return void t(d(e.result));if("message"in e)return void a.enqueue(d(e.message));if("error"in e){let t=g(0,e);a.error(t),n(t);return}}catch(e){if(e instanceof m){a.error(e),n(e);return}}},i=new TextDecoder;return new ReadableStream({start(t){let o="";return s();async function s(){if(null==a?void 0:a.aborted){let e=new m("cancelled","Request was cancelled");return t.error(e),n(e),Promise.resolve()}try{let{value:l,done:c}=await e.read();if(c){o.trim()&&r(o.trim(),t),t.close();return}if(null==a?void 0:a.aborted){let a=new m("cancelled","Request was cancelled");t.error(a),n(a),await e.cancel();return}let u=(o+=i.decode(l,{stream:!0})).split("\n");for(let e of(o=u.pop()||"",u))e.trim()&&r(e.trim(),t);return s()}catch(a){let e=a instanceof m?a:g(0,null);t.error(e),n(e)}}},cancel:()=>e.cancel()})}(i.body.getReader(),o,s,null==a?void 0:a.signal);return{stream:{[Symbol.asyncIterator](){let e=h.getReader();return{async next(){let{value:t,done:n}=await e.read();return{value:t,done:n}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:p}}let j="@firebase/functions",A="0.13.1";function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.getApp)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b,n=(0,o._getProvider)((0,s.getModularInstance)(e),p).getImmediate({identifier:t}),a=(0,s.getDefaultEmulatorHostnameAndPort)("functions");return a&&E(n,...a),n}function E(e,t,n){var a=(0,s.getModularInstance)(e);let r=(0,s.isCloudWorkstation)(t);a.emulatorOrigin="http".concat(r?"s":"","://").concat(t,":").concat(n),r&&((0,s.pingServer)(a.emulatorOrigin+"/backends"),(0,s.updateEmulatorBanner)("Functions",!0))}function I(e,t,n){var a=(0,s.getModularInstance)(e);let r=e=>(function(e,t,n,a){let r=e._url(t);return w(e,r,n,a)})(a,t,e,n||{});return r.stream=(e,n)=>(function(e,t,n,a){let r=e._url(t);return C(e,r,n,a||{})})(a,t,e,n),r}(0,o._registerComponent)(new l.Component(p,(e,t)=>{let{instanceIdentifier:n}=t,a=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal");return new y(a,r,e.getProvider("messaging-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),(0,o.registerVersion)(j,A,void 0),(0,o.registerVersion)(j,A,"esm2020");let S={apiKey:"AIzaSyDYQfltkDCGJvCgtgCNzVfyA5nUJy5KNNc",authDomain:"chamama-addfd.firebaseapp.com",projectId:"chamama-addfd",storageBucket:"chamama-addfd.firebasestorage.app",appId:"1:542858138442:web:abe34a5d9cccf70af5e7b3"},O=Object.entries(S).filter(e=>{let[t,n]=e;return!n}).map(e=>{let[t]=e;return t});if(O.length)throw Error("Firebase env missing: "+O.join(", ")+". ודא שיש קובץ .env.local בשורש הפרויקט עם NEXT_PUBLIC_FB_* אמיתיים, ואתחל מחדש את dev.");try{t=(0,n.getApps)().length?(0,n.getApps)()[0]:(0,n.initializeApp)(S)}catch(e){throw console.error("Firebase initializeApp failed. projectId:",S.projectId,e),e}let D=(0,a.getAuth)(t),P=(0,r.getFirestore)(t),R=(0,i.getStorage)(t),U=T(t);if("localhost"===location.hostname){try{(0,a.connectAuthEmulator)(D,"http://localhost:9099")}catch(e){}try{(0,r.connectFirestoreEmulator)(P,"localhost",8080)}catch(e){}try{(0,i.connectStorageEmulator)(R,"localhost",9199)}catch(e){}try{E(U,"localhost",5001)}catch(e){}}},18566,(e,t,n)=>{t.exports=e.r(76562)},93400,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(43476),n=e.i(71645),a=e.i(18566),r=e.i(11663);e.i(36180);var i=e.i(98925);function o(){let{id:e}=(0,a.useParams)(),[o,s]=(0,n.useState)(!0),[l,c]=(0,n.useState)(""),[u,d]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[m,g]=(0,n.useState)([]),f=(0,a.useRouter)(),[b,v]=(0,n.useState)(!1);async function y(){try{v(!0),await (0,i.updateDoc)((0,i.doc)(r.db,"forms",e),{title:l,targetGroups:u.split(",").map(e=>e.trim()).filter(Boolean),notifyStaffEmails:p.split(",").map(e=>e.trim()).filter(Boolean),schema:m,updatedAt:(0,i.serverTimestamp)()}),f.replace("/app")}catch(e){alert("שגיאה בשמירה: "+((null==e?void 0:e.message)||e))}finally{v(!1)}}function k(e){let t={id:crypto.randomUUID(),type:e,label:"שדה חדש",required:!1};("select"===e||"radio"===e||"checkbox"===e)&&(t.options=["אפשרות 1","אפשרות 2"]),g(e=>[...e,t])}return((0,n.useEffect)(()=>{(async()=>{let t=(await (0,i.getDoc)((0,i.doc)(r.db,"forms",e))).data();c((null==t?void 0:t.title)||""),d(((null==t?void 0:t.targetGroups)||[]).join(", ")),h(((null==t?void 0:t.notifyStaffEmails)||[]).join(", ")),g((null==t?void 0:t.schema)||[]),s(!1)})()},[e]),o)?(0,t.jsx)("main",{className:"p-6",children:"טוען…"}):(0,t.jsxs)("main",{dir:"rtl",className:"p-6 max-w-4xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-2xl mb-4",children:"עריכת טופס"}),(0,t.jsxs)("div",{className:"grid gap-3 max-w-xl",children:[(0,t.jsx)("input",{className:"border p-2",value:l,onChange:e=>c(e.target.value),placeholder:"שם הטופס"}),(0,t.jsx)("input",{className:"border p-2",value:u,onChange:e=>d(e.target.value),placeholder:"קבוצות (מופרד בפסיקים)"}),(0,t.jsx)("input",{className:"border p-2",value:p,onChange:e=>h(e.target.value),placeholder:"מיילים לשליחה (מופרד בפסיקים)"})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h2",{className:"text-xl mb-2",children:"רכיבי טופס"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("richtext"),children:"טקסט עשיר"}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("text"),children:"שדה טקסט"}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("phone"),children:"טלפון"}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("email"),children:'דוא"ל'}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("select"),children:"רשימה נגללת"}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("radio"),children:"בחירה אחת"}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("checkbox"),children:"סימונים"}),(0,t.jsx)("button",{className:"border p-2",onClick:()=>k("signature"),children:"חתימה"})]}),(0,t.jsx)("ul",{className:"space-y-2",children:m.map(e=>(0,t.jsxs)("li",{className:"border p-2 rounded",children:[(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,t.jsx)("span",{className:"text-xs px-2 py-1 border rounded",children:e.type}),(0,t.jsx)("input",{className:"border p-1 flex-1",value:e.label,onChange:t=>g(n=>n.map(n=>n.id===e.id?{...n,label:t.target.value}:n))}),(0,t.jsxs)("label",{className:"flex items-center gap-1 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:!!e.required,onChange:t=>g(n=>n.map(n=>n.id===e.id?{...n,required:t.target.checked}:n))})," נדרש"]}),(0,t.jsx)("button",{className:"text-red-600",onClick:()=>g(t=>t.filter(t=>t.id!==e.id)),children:"מחק"})]}),("select"===e.type||"radio"===e.type||"checkbox"===e.type)&&(0,t.jsx)("input",{className:"border p-1 mt-2 w-full",value:(e.options||[]).join(", "),onChange:t=>{let n=t.target.value.split(",").map(e=>e.trim()).filter(Boolean);g(t=>t.map(t=>t.id===e.id?{...t,options:n}:t))},placeholder:"אפשרויות (מופרד בפסיקים)"})]},e.id))})]}),(0,t.jsx)("button",{className:"border p-2 mt-6",onClick:y,children:"שמור"})]})}}]);