{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/chamama-forms/components/SignaturePad.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useRef } from \"react\";\r\nimport SignatureCanvas from \"react-signature-canvas\";\r\n\r\nexport default function SignaturePad({ onSave }: { onSave: (dataUrl:string)=>void }) {\r\n  const ref = useRef<SignatureCanvas>(null);\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <SignatureCanvas ref={ref} penColor=\"black\" canvasProps={{width:500,height:180, className:\"border rounded\"}} />\r\n      <div className=\"flex gap-2\">\r\n        <button onClick={()=>ref.current?.clear()} className=\"border p-2\">נקה</button>\r\n        <button onClick={()=>{ const data = ref.current?.toDataURL(\"image/png\"); if(data) onSave(data); }} className=\"border p-2\">שמור חתימה</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;AAFA;;;AAIe,SAAS,aAAa,KAA8C;QAA9C,EAAE,MAAM,EAAsC,GAA9C;;IACnC,MAAM,MAAM,IAAA,uKAAM,EAAkB;IACpC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,4KAAe;gBAAC,KAAK;gBAAK,UAAS;gBAAQ,aAAa;oBAAC,OAAM;oBAAI,QAAO;oBAAK,WAAU;gBAAgB;;;;;;0BAC1G,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAO,SAAS;gCAAI;oCAAA,eAAA,IAAI,OAAO,cAAX,mCAAA,aAAa,KAAK;;wBAAI,WAAU;kCAAa;;;;;;kCAClE,6LAAC;wBAAO,SAAS;gCAAmB;4BAAb,MAAM,QAAO,eAAA,IAAI,OAAO,cAAX,mCAAA,aAAa,SAAS,CAAC;4BAAc,IAAG,MAAM,OAAO;wBAAO;wBAAG,WAAU;kCAAa;;;;;;;;;;;;;;;;;;AAIlI;GAXwB;KAAA","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/chamama-forms/lib/firebaseClient.ts"],"sourcesContent":["// lib/firebaseClient.ts\r\nimport { initializeApp, getApps, type FirebaseApp } from \"firebase/app\";\r\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\r\nimport { getFirestore, connectFirestoreEmulator } from \"firebase/firestore\";\r\nimport { getStorage, connectStorageEmulator } from \"firebase/storage\";\r\n\r\n// --- אבחון: ודא שמשתני הסביבה קיימים (גם בשרת של Next וגם בדפדפן) ---\r\nconst cfg = {\r\n  apiKey: process.env.NEXT_PUBLIC_FB_API_KEY,\r\n  authDomain: process.env.NEXT_PUBLIC_FB_AUTH_DOMAIN,\r\n  projectId: process.env.NEXT_PUBLIC_FB_PROJECT_ID,\r\n  storageBucket: process.env.NEXT_PUBLIC_FB_STORAGE_BUCKET,\r\n  appId: process.env.NEXT_PUBLIC_FB_APP_ID,\r\n};\r\n\r\n// נבדוק את כל המפתחות החיוניים ונזרוק שגיאה ברורה אם חסר משהו:\r\nconst missing = Object.entries(cfg).filter(([_, v]) => !v).map(([k]) => k);\r\nif (missing.length) {\r\n  // חשוב: ההודעה תופיע במסוף וגם תעצור את הייבוא בצורה ברורה\r\n  throw new Error(\r\n    \"Firebase env missing: \" + missing.join(\", \") +\r\n    \". ודא שיש קובץ .env.local בשורש הפרויקט עם NEXT_PUBLIC_FB_* אמיתיים, ואתחל מחדש את dev.\"\r\n  );\r\n}\r\n\r\nconst firebaseConfig = cfg as {\r\n  apiKey: string; authDomain: string; projectId: string; storageBucket: string; appId: string;\r\n};\r\n\r\nlet app: FirebaseApp;\r\ntry {\r\n  app = getApps().length ? getApps()[0] : initializeApp(firebaseConfig);\r\n} catch (e) {\r\n  // לוג מועיל לאבחון\r\n  // eslint-disable-next-line no-console\r\n  console.error(\"Firebase initializeApp failed. projectId:\", firebaseConfig.projectId, e);\r\n  throw e;\r\n}\r\n\r\nexport { app };\r\nexport const auth = getAuth(app);\r\nexport const db = getFirestore(app);\r\nexport const storage = getStorage(app);\r\n\r\n// חיבור לאמולטורים בלוקאל\r\nif (typeof window !== \"undefined\" && location.hostname === \"localhost\") {\r\n  try { connectAuthEmulator(auth, \"http://localhost:9099\"); } catch {}\r\n  try { connectFirestoreEmulator(db, \"localhost\", 8080); } catch {}\r\n  try { connectStorageEmulator(storage, \"localhost\", 9199); } catch {}\r\n}\r\n"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;;;;;;AAQd;AAPV;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,uEAAuE;AACvE,MAAM,MAAM;IACV,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,KAAK;AACP;AAEA,+DAA+D;AAC/D,MAAM,UAAU,OAAO,OAAO,CAAC,KAAK,MAAM,CAAC;QAAC,CAAC,GAAG,EAAE;WAAK,CAAC;GAAG,GAAG,CAAC;QAAC,CAAC,EAAE;WAAK;;AACxE,IAAI,QAAQ,MAAM,EAAE;IAClB,2DAA2D;IAC3D,MAAM,IAAI,MACR,2BAA2B,QAAQ,IAAI,CAAC,QACxC;AAEJ;AAEA,MAAM,iBAAiB;AAIvB,IAAI;AACJ,IAAI;IACF,MAAM,IAAA,8KAAO,IAAG,MAAM,GAAG,IAAA,8KAAO,GAAE,CAAC,EAAE,GAAG,IAAA,oLAAa,EAAC;AACxD,EAAE,OAAO,GAAG;IACV,mBAAmB;IACnB,sCAAsC;IACtC,QAAQ,KAAK,CAAC,6CAA6C,eAAe,SAAS,EAAE;IACrF,MAAM;AACR;;AAGO,MAAM,OAAO,IAAA,wKAAO,EAAC;AACrB,MAAM,KAAK,IAAA,kLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,8KAAU,EAAC;AAElC,0BAA0B;AAC1B,IAAI,aAAkB,eAAe,SAAS,QAAQ,KAAK,aAAa;IACtE,IAAI;QAAE,IAAA,oLAAmB,EAAC,MAAM;IAA0B,EAAE,UAAM,CAAC;IACnE,IAAI;QAAE,IAAA,8LAAwB,EAAC,IAAI,aAAa;IAAO,EAAE,UAAM,CAAC;IAChE,IAAI;QAAE,IAAA,0LAAsB,EAAC,SAAS,aAAa;IAAO,EAAE,UAAM,CAAC;AACrE","debugId":null}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/chamama-forms/lib/saveSignaturePng.ts"],"sourcesContent":["// lib/saveSignaturePng.ts\r\nimport { storage } from \"@/lib/firebaseClient\";\r\nimport { ref, uploadString, getDownloadURL } from \"firebase/storage\";\r\n\r\n/** שומר dataURL של חתימה ל-Storage ומחזיר קישור הורדה */\r\nexport async function saveSignaturePng(userId: string, dataUrl: string) {\r\n  const path = `signatures/${userId}/${Date.now()}.png`;\r\n  const r = ref(storage, path);\r\n  await uploadString(r, dataUrl, \"data_url\");\r\n  const url = await getDownloadURL(r);\r\n  return { url, path };\r\n}\r\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;AAC1B;AACA;AAAA;;;AAGO,eAAe,iBAAiB,MAAc,EAAE,OAAe;IACpE,MAAM,OAAO,AAAC,cAAuB,OAAV,QAAO,KAAc,OAAX,KAAK,GAAG,IAAG;IAChD,MAAM,IAAI,IAAA,uKAAG,EAAC,mIAAO,EAAE;IACvB,MAAM,IAAA,gLAAY,EAAC,GAAG,SAAS;IAC/B,MAAM,MAAM,MAAM,IAAA,kLAAc,EAAC;IACjC,OAAO;QAAE;QAAK;IAAK;AACrB","debugId":null}},
    {"offset": {"line": 192, "column": 0}, "map": {"version":3,"sources":["file:///C:/chamama-forms/app/demo-signature/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport SignaturePad from \"@/components/SignaturePad\";\r\nimport { auth } from \"@/lib/firebaseClient\";\r\nimport { onAuthStateChanged, User } from \"firebase/auth\";\r\nimport { saveSignaturePng } from \"@/lib/saveSignaturePng\";\r\n\r\nexport default function DemoSignaturePage() {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [saving, setSaving] = useState(false);\r\n  const [msg, setMsg] = useState(\"\"); const [fileUrl, setFileUrl] = useState(\"\");\r\n\r\n  useEffect(()=>{ const u = onAuthStateChanged(auth,(x)=>{ setUser(x); if(!x) location.href=\"/login\"; }); return ()=>u(); },[]);\r\n  async function handleSave(dataUrl:string){ if(!user) return; setMsg(\"\"); setSaving(true);\r\n    try{ const {url}=await saveSignaturePng(user.uid,dataUrl); setFileUrl(url); setMsg(\"✅ נשמר ב-Storage\"); }catch(e:any){ setMsg(\"שגיאה: \"+(e?.message||e)); }finally{ setSaving(false); } }\r\n\r\n  return (\r\n    <main dir=\"rtl\" className=\"p-6 max-w-xl mx-auto\">\r\n      <h1 className=\"text-2xl mb-4\">דמו שמירת חתימה</h1>\r\n      <SignaturePad onSave={handleSave}/>\r\n      <div className=\"mt-3 text-sm\">{saving ? \"שומר...\" : msg}</div>\r\n      {fileUrl && <div className=\"mt-4\"><a className=\"text-blue-600 underline\" href={fileUrl} target=\"_blank\">פתח קובץ</a><div className=\"border mt-2 p-2\"><img src={fileUrl} alt=\"חתימה\" className=\"max-w-full\"/></div></div>}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AAAA;AACA;;;AALA;;;;;;AAOe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAC;IAAK,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAE3E,IAAA,0KAAS;uCAAC;YAAM,MAAM,IAAI,IAAA,mLAAkB,EAAC,gIAAI;iDAAC,CAAC;oBAAM,QAAQ;oBAAI,IAAG,CAAC,GAAG,SAAS,IAAI,GAAC;gBAAU;;YAAI;+CAAO,IAAI;;QAAK;sCAAE,EAAE;IAC5H,eAAe,WAAW,OAAc;QAAG,IAAG,CAAC,MAAM;QAAQ,OAAO;QAAK,UAAU;QACjF,IAAG;YAAE,MAAM,EAAC,GAAG,EAAC,GAAC,MAAM,IAAA,8IAAgB,EAAC,KAAK,GAAG,EAAC;YAAU,WAAW;YAAM,OAAO;QAAqB,EAAC,OAAM,GAAM;YAAE,OAAO,YAAU,CAAC,CAAA,cAAA,wBAAA,EAAG,OAAO,KAAE,CAAC;QAAI,SAAQ;YAAE,UAAU;QAAQ;IAAE;IAE1L,qBACE,6LAAC;QAAK,KAAI;QAAM,WAAU;;0BACxB,6LAAC;gBAAG,WAAU;0BAAgB;;;;;;0BAC9B,6LAAC,yIAAY;gBAAC,QAAQ;;;;;;0BACtB,6LAAC;gBAAI,WAAU;0BAAgB,SAAS,YAAY;;;;;;YACnD,yBAAW,6LAAC;gBAAI,WAAU;;kCAAO,6LAAC;wBAAE,WAAU;wBAA0B,MAAM;wBAAS,QAAO;kCAAS;;;;;;kCAAY,6LAAC;wBAAI,WAAU;kCAAkB,cAAA,6LAAC;4BAAI,KAAK;4BAAS,KAAI;4BAAQ,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAGpM;GAjBwB;KAAA","debugId":null}}]
}